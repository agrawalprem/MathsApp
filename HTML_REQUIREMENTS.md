# HTML Requirements Documentation

This document contains the requirements for all HTML files in the application, written in reverse engineering format (requirements derived from code).

## Table of Contents
- [Main Application (index.html)](#main-application-indexhtml)
- [Teacher Dashboard (teacher-dashboard.html)](#teacher-dashboard-teacher-dashboardhtml)
- [Bulk Upload Students (bulk-upload-students.html)](#bulk-upload-students-bulk-upload-studentshtml)

---

## Main Application (index.html)

### File Overview
**Requirements:**
- Main application HTML file
- Loads all CSS and JavaScript modules in correct order
- Contains dashboard, quiz, and summary sections
- Contains authentication and password reset modals
- Initializes Supabase and handles password reset callbacks
- Manages global state (selectedOperation, passedVariants, failedVariants, learningSequence)

**Referenced By:**
- All CSS modules (shared.css, auth.css, header.css, dashboard.css, quiz.css, summary.css)
- All JavaScript modules (shared.js, db.js, auth.js, header.js, dashboard.js, quiz.js, summary.js)
- Entry point for the entire application

### Head Section
**Requirements:**
- Loads Supabase JS library from CDN
- Loads all CSS modules in order: shared.css, auth.css, header.css, dashboard.css, quiz.css, summary.css
- Loads all JavaScript modules in order: shared.js, db.js, auth.js, header.js, dashboard.js, quiz.js, summary.js
- Sets viewport meta tag for responsive design
- Sets page title

**Referenced By:**
- Browser: Renders page and loads all dependencies
- All modules: Depend on correct loading order

### Container Element (`.container`)
**Requirements:**
- Main container for all application content
- Uses `.container` class from shared.css
- Contains header, dashboard, quiz, and summary sections

**Referenced By:**
- shared.css (`.container` styles)
- All child sections are contained within this element

### Header Section (`.header`)
**Requirements:**
- Application header with title "Learning Maths" and subtitle "in Baby Steps"
- Uses `.header` class from dashboard.css

**Referenced By:**
- dashboard.css (`.header` styles)

### Dashboard Section (`#dashboardSection`)
**Requirements:**
- Main dashboard section containing login form, operations grid, and variants
- Hidden by default (`.hidden` class), shown when user is logged in or as guest
- Contains inline login form, guest notice, operation cards, and variant cards

**Referenced By:**
- dashboard.js: `updateAuthUI()` (shows/hides), `selectOperation()` (shows), `loadVariantsForOperation()` (populates variants)
- db.js: `fetchUserProfile()` (shows after login), `fetchPassedVariants()` (updates variant status)
- dashboard.css (`.dashboard-section` styles)

### Login Section (`#loginSection`)
**Requirements:**
- Inline login form within dashboard
- Contains email/password inputs and login/logout buttons
- Shows/hides based on authentication state
- Contains user display and error message elements
- Contains links to forgot password and signup modals

**Referenced By:**
- dashboard.js: `handleInlineLogin()` (form submission), `updateAuthUI()` (shows/hides login/logout buttons)
- header.js: `updateUserDisplay()` (updates user information)
- header.css (`.login-section`, `.login-form`, `.login-error`, `.user-display` styles)

### Guest Notice (`#guestNotice`)
**Requirements:**
- Notice displayed when user is not logged in
- Informs user that results won't be saved
- Hidden by default, shown for guest users

**Referenced By:**
- dashboard.js: `updateAuthUI()` (shows/hides based on login status)
- dashboard.css (`.guest-notice` styles)

### Operations Grid (`.operations-grid`)
**Requirements:**
- Grid of 4 operation cards (addition, subtraction, multiplication, division)
- Each card is clickable and calls `selectOperation()` with operation name
- Cards can have `selected` and `completed` classes added dynamically
- Each card contains operation symbol and name

**Referenced By:**
- dashboard.js: `selectOperation()` (handles clicks, adds `selected` class), `updateOperationCompletionStatus()` (adds `completed` class)
- dashboard.css (`.operations-grid`, `.operation-card`, `.operation-card.selected`, `.operation-card.completed` styles)

### Variants Container (`#variantsContainer`)
**Requirements:**
- Container for variant cards dynamically generated by `loadVariantsForOperation()`
- Cards show variant names and pass/fail status
- Cards are clickable and call `launchVariant()` when clicked
- Empty by default, populated when operation is selected

**Referenced By:**
- dashboard.js: `loadVariantsForOperation()` (creates and populates cards), `launchVariant()` (handles card clicks)
- dashboard.css (`.variants-container`, `.variant-card`, `.variant-card.passed`, `.variant-card.failed` styles)

### Question Section (`#questionSection`)
**Requirements:**
- Quiz/question section displayed during active quiz session
- Contains timer, question lines, answer input, and correct answer display
- Hidden by default, shown when quiz session starts
- Supports both single-digit (`answerInput`) and multi-digit (`multidigitTable`) input modes

**Referenced By:**
- quiz.js: `startSession()` (shows section), `displayQuestion()` (updates question content), `setupNormalInput()` (shows single-digit input), `setupRightToLeftInput()` (shows multi-digit table), `checkAnswer()` (displays correct answer), `startTimer()` (updates timer)
- summary.js: `endSession()` (hides section)
- quiz.css (`.question-container`, `.question-line`, `.answer-input`, `.multidigit-table`, `.timer`, `.correct-answer` styles)

### Answer Input (`#answerInput`)
**Requirements:**
- Number input for single-digit operations
- Hidden when multi-digit table is active
- Receives user answer input

**Referenced By:**
- quiz.js: `setupNormalInput()` (shows), `setupRightToLeftInput()` (hides), `checkAnswer()` (reads value)
- quiz.css (`.answer-input` styles)

### Multidigit Table (`#multidigitTable`)
**Requirements:**
- Table for multi-digit operations
- Dynamically created by `setupRightToLeftInput()`
- Hidden for single-digit operations
- Contains cells for operation display and answer input

**Referenced By:**
- quiz.js: `setupRightToLeftInput()` (creates and shows), `setupNormalInput()` (hides), `handleClick()` (handles cell clicks), `handleKeyPress()` (handles keyboard input)
- quiz.css (`.multidigit-table`, `.multidigit-table td.input-cell`, `.multidigit-table td.operation-cell` styles)

### Summary Section (`#summarySection`)
**Requirements:**
- Summary section displayed after quiz session ends
- Shows session statistics, pass/fail status, and question details
- Hidden by default, shown when session ends
- Contains "Go Back" button to return to dashboard

**Referenced By:**
- summary.js: `endSession()` (shows section), `showSummary()` (populates content), `resetSession()` (hides section)
- quiz.js: `startSession()` (hides section)
- summary.css (`.summary-section`, `.summary-stats`, `.pass-fail`, `.question-details` styles)

### Termination Modal (`#modal`)
**Requirements:**
- Modal shown after 50 questions
- Allows user to continue or end session
- Hidden by default, shown by `showTerminationModal()`

**Referenced By:**
- quiz.js: `showTerminationModal()` (shows), `continueSession()` (hides and continues), `endSession()` (hides and ends)
- auth.css (`.modal`, `.modal-content`, `.modal-buttons` styles)

### Authentication Modal (`#authModal`)
**Requirements:**
- Modal for login and signup forms
- Toggles between login and signup modes
- Contains form fields for authentication
- Hidden by default, shown by `showLoginModal()` or `showSignupModal()`

**Referenced By:**
- auth.js: `showLoginModal()` (shows login form), `showSignupModal()` (shows signup form), `closeAuthModal()` (hides), `handleAuth()` (processes form), `toggleAuthMode()` (switches between login/signup)
- auth.css (`#authModal`, `.auth-modal-content`, `.auth-form`, `.auth-error` styles)

### Forgot Password Modal (`#forgotPasswordModal`)
**Requirements:**
- Modal for password reset functionality
- Contains request form (email input) and reset form (new password)
- Toggles between request and reset forms based on URL parameters
- Hidden by default, shown by `showForgotPasswordModal()`

**Referenced By:**
- auth.js: `showForgotPasswordModal()` (shows), `closeForgotPasswordModal()` (hides), `handleForgotPassword()` (processes request), `handleResetPassword()` (processes reset)
- auth.css (`.modal`, `.auth-modal-content`, `.auth-error` styles)
- index.html: `DOMContentLoaded` event listener (checks for password reset URL parameters)

### Global State Variables
**Requirements:**
- `selectedOperation`: Currently selected operation (addition, subtraction, multiplication, division)
- `window.passedVariants`: Set of passed variant keys (operation_variant format)
- `window.failedVariants`: Set of failed variant keys (operation_variant format)
- `window.learningSequence`: Object mapping operations to ordered variant arrays

**Referenced By:**
- dashboard.js: `selectOperation()` (sets selectedOperation), `loadVariantsForOperation()` (uses learningSequence)
- db.js: `fetchPassedVariants()` (updates passedVariants), `fetchFailedVariants()` (updates failedVariants)
- quiz.js: `startSession()` (uses selectedOperation)

### Event Listeners
**Requirements:**
- `DOMContentLoaded`: Initializes Supabase, checks for password reset links, handles email confirmation
- `authModal` click: Closes modal when clicking outside
- `forgotPasswordModal` click: Closes modal when clicking outside
- `signupUserType` change: Updates signup form fields based on user type

**Referenced By:**
- Browser: Triggers on page load and user interactions
- auth.js: Functions called by event handlers

---

## Teacher Dashboard (teacher-dashboard.html)

### File Overview
**Requirements:**
- Teacher dashboard for viewing student progress across all variants
- Displays progress table with students as rows and variants as columns
- Shows pass/fail status for each student-variant combination
- Supports Excel export functionality
- Requires teacher authentication

**Referenced By:**
- teacher-dashboard.js: `loadDashboard()`, `buildProgressTable()`, `exportToExcel()`
- teacher-dashboard.css (all styles)
- Supabase: Fetches student data and progress from database

### Head Section
**Requirements:**
- Loads teacher-dashboard.css stylesheet
- Loads ExcelJS library from CDN for Excel export
- Loads Supabase JS library from CDN
- Sets viewport meta tag for responsive design
- Sets page title

**Referenced By:**
- Browser: Renders page and loads dependencies
- teacher-dashboard.js: Uses Supabase and ExcelJS libraries

### Container Element (`.container`)
**Requirements:**
- Main container for dashboard content
- Uses `.container` class from teacher-dashboard.css

**Referenced By:**
- teacher-dashboard.css (`.container` styles)

### Header Section (`.header`)
**Requirements:**
- Header with title "Teacher Dashboard - Student Progress"
- Contains teacher name display and logout button
- Uses `.header` class from teacher-dashboard.css

**Referenced By:**
- teacher-dashboard.js: `loadDashboard()` (sets `#teacherName` text)
- teacher-dashboard.css (`.header`, `.user-info` styles)

### Loading Message (`#loadingMessage`)
**Requirements:**
- Loading message shown while fetching data
- Hidden when data is loaded

**Referenced By:**
- teacher-dashboard.js: `showLoading()` (shows/hides)
- teacher-dashboard.css (`.loading-message` styles)

### Error Message (`#errorMessage`)
**Requirements:**
- Error message displayed when data fetch fails
- Hidden by default, shown by `showError()`

**Referenced By:**
- teacher-dashboard.js: `showError()` (adds/removes `hidden` class)
- teacher-dashboard.css (`.error-message`, `.hidden` styles)

### Dashboard Controls (`#dashboardControls`)
**Requirements:**
- Dashboard controls with export button and statistics
- Hidden by default, shown when data is loaded
- Displays total students and total variants counts

**Referenced By:**
- teacher-dashboard.js: `loadDashboard()` (removes `hidden` class, sets `#studentCount` and `#variantCount` text)
- teacher-dashboard.css (`.dashboard-controls`, `.stats` styles)

### Dashboard Grid (`#dashboardGrid`)
**Requirements:**
- Grid container for progress table
- Contains scrollable table with students and variants
- Hidden by default, shown when data is loaded

**Referenced By:**
- teacher-dashboard.js: `loadDashboard()` (removes `hidden` class), `buildProgressTable()` (populates `#tableHead` and `#tableBody`)
- teacher-dashboard.css (`.dashboard-grid-container`, `.grid-wrapper`, `.progress-table` styles)

### Progress Table (`#progressTable`)
**Requirements:**
- Table displaying student progress across variants
- Headers dynamically generated from variant list
- Rows dynamically generated from student list
- Cells show pass/fail status with color coding

**Referenced By:**
- teacher-dashboard.js: `buildProgressTable()` (creates table structure, adds `fixed-column`, `status-pass`, `status-fail`, `status-empty` classes)
- teacher-dashboard.css (`.progress-table`, `.progress-table th.fixed-column`, `.progress-table td.fixed-column`, `.status-pass`, `.status-fail`, `.status-empty` styles)

---

## Bulk Upload Students (bulk-upload-students.html)

### File Overview
**Requirements:**
- Admin tool for bulk uploading students via CSV
- Supports auto-generated passwords, default password, or student ID as password
- Creates users in Supabase Auth and user_profiles table
- Provides CSV template download and password file download
- Self-contained (no external CSS/JS modules)

**Referenced By:**
- Inline JavaScript: `uploadStudents()`, `downloadTemplate()`, `downloadPasswords()`
- Supabase: Creates auth users and user profiles

### Head Section
**Requirements:**
- Loads Supabase JS library from CDN
- Contains inline styles for all UI elements
- Sets viewport meta tag for responsive design
- Sets page title

**Referenced By:**
- Browser: Renders page and loads Supabase library
- Inline JavaScript: Uses Supabase client

### Container Element (`.container`)
**Requirements:**
- Main container for upload form and results
- Uses inline styles

**Referenced By:**
- Inline CSS (`.container` styles)

### Password Options
**Requirements:**
- Radio buttons for password generation options:
  - Auto-generate (8 characters)
  - Default password (user-specified)
  - Use Student ID as password
- Default password input enabled/disabled based on selection

**Referenced By:**
- Inline JavaScript: `uploadStudents()` (reads selected option), event listener (enables/disables default password input)

### CSV Data Input (`#csvData`)
**Requirements:**
- Textarea for pasting CSV data
- File input for uploading CSV file
- CSV format: student_id,first_name,last_name,gender,school_id,class,section,roll_number

**Referenced By:**
- Inline JavaScript: `uploadStudents()` (reads CSV data), file input event listener (loads file into textarea), `parseCSV()` (parses CSV text)

### Upload Button
**Requirements:**
- Button to trigger student upload
- Calls `uploadStudents()` function

**Referenced By:**
- Inline JavaScript: `uploadStudents()` (processes upload)

### Template Download Button
**Requirements:**
- Button to download CSV template
- Calls `downloadTemplate()` function

**Referenced By:**
- Inline JavaScript: `downloadTemplate()` (creates and downloads CSV file)

### Results Container (`#results`)
**Requirements:**
- Container for displaying upload results
- Shows success/error messages and detailed results
- Dynamically populated by `displayResults()`

**Referenced By:**
- Inline JavaScript: `displayResults()` (populates with results), `showDownloadButton()` (adds download button), `showError()` (shows error), `showInfo()` (shows info)

---

## Summary

All HTML files have been documented with:
- **Requirements**: What each element/section does and its purpose
- **Referenced By**: Which JavaScript functions, CSS files, and other modules interact with each element

This documentation helps understand:
- The structure and organization of the application
- How different modules interact with HTML elements
- Where to find code that manipulates specific elements
- The flow of data and user interactions through the UI
